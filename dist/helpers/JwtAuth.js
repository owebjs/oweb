import{a as e}from"../chunk-2HA4XQFN.js";import c from"jsonwebtoken";var h=e(({secret:r,onError:i})=>function(n){return class extends n{static{e(this,"JWT")}constructor(o,s,a){super();let t=o?.headers?.authorization;if(t&&(t=t.trim(),t=t.slice(Math.max(t.lastIndexOf(" "),0))),r)try{this.jwtResult=c.verify(t,r)}catch{i&&i(o,s,a)}else throw new Error("JWT Secret not provided!")}}},"JwtAuth");export{h as JwtAuth};
