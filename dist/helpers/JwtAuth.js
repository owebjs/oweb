import{a as e}from"../chunk-2HA4XQFN.js";import a from"jsonwebtoken";function h({secret:i,onError:n}){return function(s){return class extends s{static{e(this,"JWT")}constructor(r,u){super();let t=r?.headers?.authorization;if(t&&(t=t.trim(),t=t.slice(Math.max(t.lastIndexOf(" "),0))),i&&t?.length>0)try{this.jwtResult=a.verify(t,i)}catch{n&&n(r,u)}}}}}e(h,"JwtAuth");export{h as JwtAuth};
